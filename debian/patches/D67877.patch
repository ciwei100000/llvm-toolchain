Origin: https://reviews.llvm.org/D67877
Bug-Debian: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=941082

Index: llvm-toolchain-9-9~+rc5/clang/lib/Analysis/plugins/CMakeLists.txt
===================================================================
--- llvm-toolchain-9-9~+rc5.orig/clang/lib/Analysis/plugins/CMakeLists.txt
+++ llvm-toolchain-9-9~+rc5/clang/lib/Analysis/plugins/CMakeLists.txt
@@ -1,4 +1,4 @@
-if(CLANG_ENABLE_STATIC_ANALYZER AND LLVM_ENABLE_PLUGINS)
+if(CLANG_ENABLE_STATIC_ANALYZER AND LLVM_ENABLE_PLUGINS AND CLANG_BUILD_EXAMPLES)
   add_subdirectory(SampleAnalyzer)
   add_subdirectory(CheckerDependencyHandling)
   add_subdirectory(CheckerOptionHandling)
Index: llvm-toolchain-9-9~+rc5/clang/test/CMakeLists.txt
===================================================================
--- llvm-toolchain-9-9~+rc5.orig/clang/test/CMakeLists.txt
+++ llvm-toolchain-9-9~+rc5/clang/test/CMakeLists.txt
@@ -123,14 +123,12 @@
   endif()
 endif()
 
-if (CLANG_ENABLE_STATIC_ANALYZER)
-  if (LLVM_ENABLE_PLUGINS)
-    list(APPEND CLANG_TEST_DEPS
-      SampleAnalyzerPlugin
-      CheckerDependencyHandlingAnalyzerPlugin
-      CheckerOptionHandlingAnalyzerPlugin
-      )
-  endif()
+if (CLANG_ENABLE_STATIC_ANALYZER AND CLANG_BUILD_EXAMPLES AND LLVM_ENABLE_PLUGINS)
+  list(APPEND CLANG_TEST_DEPS
+    SampleAnalyzerPlugin
+    CheckerDependencyHandlingAnalyzerPlugin
+    CheckerOptionHandlingAnalyzerPlugin
+    )
 endif()
 
 add_custom_target(clang-test-depends DEPENDS ${CLANG_TEST_DEPS})
